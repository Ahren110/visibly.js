(function(){window.visibly={b:null,q:document,p:undefined,prefixes:["webkit","ms"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],_callbacks:[],onVisible:function(a){this.visibleCallbacks.push(a)},onHidden:function(a){this.hiddenCallbacks.push(a)},isSupported:function(){return this._supports(0)||this._supports(1)},_supports:function(a){return this.prefixes[a]+this.props[2]in this.q},runCallbacks:function(a){if(a){this._callbacks=a==1?this.visibleCallbacks:this.hiddenCallbacks;for(var b=0;b<this._callbacks.length;b++)this._callbacks[b]()}},_visible:function(){window.visibly.runCallbacks(1)},_hidden:function(){window.visibly.runCallbacks(2)},_nativeSwitch:function(){var a=this.q[this.b+this.props[2]];this[a?"_hidden":"_visible"]()},listen:function(){try{this.isSupported()?(this.b=this.prefixes[+(this._supports(0)==this.p)],this.q.addEventListener(this.b+this.props[1],function(){window.visibly._nativeSwitch.apply(window.visibly,arguments)},1)):document.addEventListener?(console.log("here"),window.addEventListener(this.m[0],this._visible,1),window.addEventListener(this.m[1],this._hidden,1)):(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(a){}},init:function(){this.listen()}},this.visibly.init()})()